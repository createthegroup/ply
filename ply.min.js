var Ply={VERSION:"0.1.0"};
Ply.core=function(f){var g={},b=!1;return{notify:function(a,b,c){var h=g[a],d=0,f=h.length;for(h||(g[a]=[]);d<f;d++)h[d].handler.apply(h[d].listener,[a,b,c])},listen:function(a,b,c){var h=g[a],d=a.split(/\s/),f=d.length,i=0;if(f>1)for(;i<f;i++)this.listen(d[i],b,c);else h||(g[a]=[]),h.push({handler:b,listener:c})},log:function(a,e){if(b&&window.console)switch(e){case "warn":console.warn(a);break;case "info":console.info(a);break;default:console.log(a)}},error:function(a,b){f.post(Ply.config.core.errorLoggingUrl,
{name:a.name,description:a.description,message:a.message,lineNumber:a.lineNumber,stackTrace:a.stack});b>1&&alert("An error has occurred. Please refresh your browser")},debug:function(a){b=a||!0;this.log("debugging...","info");this.debugOn=!0;this.debugOn=!1},debugOn:!!b}}(jQuery);
Ply.ajax=function(f){return{request:function(g,b,a){var e=g||{},g=e.type||"GET",c=e.url||"",e=e.data||{};if(Ply.core.debugOn)e.debug=!0;try{return f.ajax({type:g,url:c,data:e,success:function(a){b&&typeof b==="function"&&b(a)},error:function(b){Ply.core.log("AjaxError: "+b.status+" - "+c,"warn");Ply.core.error({name:"AjaxError",message:"Status: "+b.status,description:"URL: "+c},1);a&&typeof a==="function"&&a(b)}})}catch(h){Ply.core.log(h.message),Ply.core.error(h,1)}}}}(jQuery);
Ply.read=function(){return{_create:function(f,g){g=g||Ply.config.read.urlGenerator(f);Ply.read[f]=function(b,a,e){return Ply.ajax.request({url:g,type:"GET",data:b},a,e)}}}}();
Ply.ui=function(f){function g(b,a,e,c,h){var d=this;this.view=a;this.delegate=h;this.opts=f.extend({},Ply.config.ui.defaults,this.opts,e);this.data=f.extend({},this.data,c);this.name=b;if(this.__objects)this.objects={},this.__bindObjects=function(){for(var a in d.__objects)d.__objects.hasOwnProperty(a)&&(d.objects[a]=d.view.find(d.__objects[a]))},this.__bindObjects();if(this.__partials)this.partials={},this.__bindPartials=function(){for(var a in d.__partials)d.__partials.hasOwnProperty(a)&&d.objects[a]&&
d.objects[a].length&&(d.partials[a]=Ply.ui.register(d.__partials[a],{view:d.objects[a],delegate:d}))},this.__bindPartials();if(this.__notifications)for(var g in this.__notifications)this.__notifications.hasOwnProperty(g)&&Ply.core.listen(g,this[this.__notifications[g]],this);this.__init&&typeof this.__init==="function"&&this.__init();return this}return{fn:{},define:function(b,a){var e=this,c=f.extend({},Ply.config.ui.base||{});Ply.read[b]||Ply.read._create(b,a.__url);c.read=Ply.read[b];this.fn[b]=
function(a,d,c,i){return g.call(f.extend({},e.fn[b].impl),b,a,d,c,i)};this.fn[b].impl=f.extend({},c,a)},create:function(b,a){var e=this,c=Array.prototype.slice.call(arguments),a=c[c.length-1],c=c.slice(1,c.length-1);c.push(function(c){a.view=c;e.register(b,a)});Ply.read[b].apply(this,c)},register:function(b,a){a=a||{};if(Ply.config.ui.onRegister&&typeof Ply.config.ui.onRegister==="function")Ply.config.ui.onRegister(b,a);if(!a.view)a.view=Ply.config.ui.selectorGenerator(b),Ply.core.log("No view name supplied, implying: "+
a.view);return this.start(b,a)},start:function(b,a){Ply.core.log("trying start: "+b,"info");try{return this.fn[b](f(a.view),a.options,a.data,a.delegate)}catch(e){if(Ply.core.log(b+" failed to start."),Ply.core.error(e,1),Ply.core.debugOn)throw e;}}}}(jQuery);
