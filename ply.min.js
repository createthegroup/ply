window.Ply={VERSION:"0.2.1"};
Ply.core=function(){var d={},b=!1;return{notify:function(a,e,b){for(var g=d[a]||(d[a]=[]),h=0,f=g.length;h<f;h++)g[h].handler.call(g[h].listener,a,e,b)},listen:function(a,e,b){var g=d[a]||(d[a]=[]),a=a.split(/\s/),h=a.length,f=0;if(h>1)for(;f<h;f++)this.listen(a[f],e,b);else g.push({handler:e,listener:b})},log:function(a,e){if(b&&window.console)switch(e){case "warn":console.warn(a);break;case "info":console.info(a);break;default:console.log(a)}},error:function(a,b){if(Ply.config.core.onError&&typeof Ply.config.core.onError===
"function")Ply.config.core.onError(a,b);else throw a;},debug:function(a){b=a||!0;this.log("debugging...","info");this.debugOn=!0},debugOn:!!b}}(jQuery);
Ply.ajax=function(d){return{request:function(b,a,e){var c=b||{},b=c.type||"GET",g=c.url||"",c=c.data||{};if(Ply.core.debugOn)c.debug=!0;try{return d.ajax({type:b,url:g,data:c,success:function(b,e,c){a&&typeof a==="function"&&a(b,e,c)},error:function(a,b,c){Ply.core.log("AjaxError: "+b+" - "+g,"warn");Ply.core.error({name:"AjaxError",message:"Status: "+b,description:"URL: "+g},1);e&&typeof e==="function"&&e(a,b,c)}})}catch(h){Ply.core.log(h.message),Ply.core.error(h,1)}}}}(jQuery);
Ply.read=function(){return{_create:function(d,b){b=b||Ply.config.read.urlGenerator(d);Ply.read[d]=function(a,e,c){return Ply.ajax.request({url:b,type:"GET",data:a},e,c)}}}}();if(!Object.create)Object.create=function(d){function b(){}if(arguments.length>1)throw Error("Object.create implementation only accepts first parameter.");b.prototype=d;return new b};
Ply.ui=function(d){function b(a,b,c,g,h){var f=this;this.name=a;this.view=b;this.delegate=h;this.options=d.extend({},Ply.config.ui.defaults,this.options,c);this.data=d.extend({},this.data,g);if(this.__objects)this.objects={},this.__bindObjects=function(){for(var a in f.__objects)f.__objects.hasOwnProperty(a)&&(f.objects[a]=f.view.find(f.__objects[a]))},this.__bindObjects();if(this.__partials)this.partials={},this.__bindPartials=function(){for(var a in f.__partials)f.__partials.hasOwnProperty(a)&&
f.objects[a]&&f.objects[a].length&&(f.partials[a]=Ply.ui.register(f.__partials[a],{view:f.objects[a],delegate:f}))},this.__bindPartials();if(this.__notifications)for(var i in this.__notifications)this.__notifications.hasOwnProperty(i)&&Ply.core.listen(i,this[this.__notifications[i]],this);this.__init&&typeof this.__init==="function"&&this.__init();return this}return{fn:{},define:function(a,e){var c=this,g=Ply.config.ui.base||{};Ply.read[a]||Ply.read._create(a,e.__url);this.fn[a]=function(e,f,d,g){return b.call(Object.create(c.fn[a].impl),
a,e,f,d,g)};this.fn[a].impl=d.extend(Object.create(g),e);this.fn[a].impl.read=Ply.read[a]},register:function(a,b){var c=Ply.config.ui,b=b&&typeof b==="object"?b:{};if(c.onRegister&&typeof c.onRegister==="function")c.onRegister(a,b);if(!b.view)b.view=c.selectorGenerator(a),Ply.core.log("No view name supplied, implying: "+b.view);return this.start(a,b)},start:function(a,b){Ply.core.log("trying start: "+a,"info");try{return this.fn[a](d(b.view),b.options,b.data,b.delegate)}catch(c){if(Ply.core.log(a+
" failed to start."),Ply.core.error(c,1),Ply.core.debugOn)throw c;}}}}(jQuery);
Ply.config=function(d){return{core:{onError:function(b,a){d.post("/error/logclienterror",{name:b.name,description:b.description,message:b.message,lineNumber:b.lineNumber,stackTrace:b.stack});a>1&&alert("An error has occurred. Please refresh your browser")}},read:{urlGenerator:function(b){return"/"+b.replace("_","/").replace("-","").toLowerCase()}},ui:{base:{},defaults:{},selectorGenerator:function(b){var b=b.match(/[A-Z]?[a-z]+/g).join("_").toLowerCase(),a=b.split("_")[0],b=a+"_"+b.substr(a.length+
1).replace("_","-");return".view-"+b+", ."+b},onRegister:function(b,a){if(a.modal)a.modal=typeof a.modal==="object"?a.modal:{},d.modal(a.view,{containerId:a.modal.containerId,dataClass:a.modal.dataClass,maxWidth:a.modal.maxWidth||300,maxHeight:a.modal.maxHeight,updateOnOpen:a.modal.updateOnOpen,onShow:function(e){a.view=e.data;Ply.ui.start(b,a);e.data.delegate(".modal-close","click",function(a){a.preventDefault();d.modal.close()})}})}}}}(jQuery);
